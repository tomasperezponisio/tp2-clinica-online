<div class="container bg-light rounded">

  <!-- Step 1: Select Paciente (Admin Only) -->
  <div *ngIf="userRole === 'admin' && step === 1" class="container mt-4 step">
    <h3 class="mb-4 text-center">Seleccione un Paciente</h3>
    <div *ngFor="let paciente of pacientes" class="card mb-2">
      <div class="card-body">
        <h5 class="card-title">{{ paciente.nombre }} {{ paciente.apellido }}</h5>
        <p class="card-text">
          <strong>Email:</strong> {{ paciente.email }}
        </p>
        <button class="btn btn-primary" (click)="elegirPaciente(paciente)">Seleccionar Paciente</button>
      </div>
    </div>
  </div>

  <div *ngIf="(userRole !== 'admin' && step === 1) || (userRole === 'admin' && step === 2)" class="container mt-4 step">
    <!-- Step 1: Select Especialidad -->
    <h3 class="mb-4 text-center">Seleccione una Especialidad</h3>
    <div class="row">
      <div class="col-12">
        <div class="d-flex flex-wrap justify-content-center">
          <button
            *ngFor="let esp of especialidades"
            class="btn btn-outline-primary m-2"
            (click)="elegirEspecialidad(esp)"
          >
            {{ esp }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="(userRole !== 'admin' && step === 2) || (userRole === 'admin' && step === 3)" class="container mt-4">
    <!-- Step 2: Select Especialista -->
    <h3 class="mb-4 text-center">Seleccione un Especialista</h3>
    <div class="row">
      <div class="col-12">
        <div class="d-flex flex-wrap justify-content-center">
          <button
            *ngFor="let especialista of especialistas"
            class="btn btn-outline-primary m-2"
            (click)="elegirEspecialista(especialista)"
          >
            {{ especialista.nombre }} {{ especialista.apellido }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="(userRole !== 'admin' && step === 3) || (userRole === 'admin' && step === 4)" class="container mt-4">
    <!-- Step 3: Select Appointment Slot -->
    <h3 class="mb-4 text-center">Seleccione un Turno</h3>
    <div class="appointments-grid">
      <div *ngFor="let date of traerFechas()" class="date-group mb-4">
        <h4 class="mb-3">{{ toTitleCase( date | date: 'fullDate' ) }}</h4>
        <div class="d-flex flex-wrap">
          <button
            *ngFor="let slot of traerBloquesPorFecha(date)"
            class="btn btn-outline-success m-2"
            (click)="seleccionarBloque(slot)"
          >
            {{ slot.hora }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="(userRole !== 'admin' && step === 4) || (userRole === 'admin' && step === 5)" class="container mt-4">
    <!-- Step 4: Confirm Appointment -->
    <h3 class="mb-4 text-center">Confirmar Turno</h3>
    <div class="card">
      <div class="card-body">
        <p><strong>Especialidad:</strong> {{ especialidadSeleccionada }}</p>
        <p>
          <strong>Especialista:</strong>
          {{ especialistaSeleccionado?.nombre }} {{ especialistaSeleccionado?.apellido }}
        </p>
        <p>
          <strong>Fecha:</strong> {{ bloqueSeleccionado?.fecha | date: 'fullDate' }}
        </p>
        <p><strong>Hora:</strong> {{ bloqueSeleccionado?.hora }}</p>
        <div class="text-center mt-4">
          <button class="btn btn-primary m-2" (click)="confirmarTurno()">
            Confirmar
          </button>
          <button class="btn btn-secondary m-2" (click)="resetSelections()">
            Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>


</div>
